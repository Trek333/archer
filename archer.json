{
    "appid": "c4492201-fd2c-49d8-b38f-805b0967032f",
    "name": "RSA Archer",
    "description": "This app implements ticket management actions on RSA Archer GRC.",
    "publisher": "Phantom",
    "package_name": "phantom_archer",
    "type": "ticketing",
    "license": "Copyright (c) Phantom Cyber Corporation 2016-2017",
    "main_module": "archer_connector.pyc",
    "app_version": "1.0.42",
    "utctime_updated": "2017-12-19T23:40:00.000000Z",
    "product_vendor": "RSA",
    "product_name": "Archer GRC",
    "product_version_regex": ".*",
    "min_phantom_version": "2.1.467",
    "logo": "rsa-logo.png",
    "configuration": {
        "endpoint_url": {
            "description": "API endpoint (e.g., http://host/RSAarcher)",
            "data_type": "string",
            "order": 1,
            "required": true
        },
        "instance_name": {
            "description": "Instance name (e.g., Default)",
            "data_type": "string",
            "order": 2,
            "required": true
        },
        "username": {
            "description": "Username",
            "data_type": "string",
            "order": 3,
            "required": true
        },
        "password": {
            "description": "Password",
            "data_type": "password",
            "order": 4,
            "required": false
        },
        "verify_ssl": {
            "description": "Verify server certificate",
            "data_type": "boolean",
            "order": 5,
            "required": false
        },
        "cef_mapping": {
            "description": "CEF to Archer mapping",
            "data_type": "string",
            "order": 6,
            "required": false
        },
        "exclude_fields": {
            "description": "Fields to exclude (comma separated)",
            "data_type": "string",
            "order": 7,
            "required": false
        }
    },
    "actions": [
        {
            "action": "test connectivity",
            "description": "Validate the asset configuration for connectivity and field mapping.",
            "type": "test",
            "identifier": "test_asset_connectivity",
            "read_only": true,
            "parameters": {},
            "output": [],
            "versions": "EQ(*)"
        },
        {
            "action": "create ticket",
            "description": "Create a new ticket.",
            "verbose": "<p>JSON specifying the field names and values for a new Archer record (key/value pairs). For Cross-Reference fields, the value must be the content id of the referenced content.</p><p>Create record sample JSON: </p><pre><code>{ \"Incident Summary\": \"test incident summary data\", \"Incident Owner\": \"susan\" }</code></pre>",
            "type": "generic",
            "identifier": "create_ticket",
            "read_only": false,
            "parameters": {
                "application": {
                    "data_type": "string",
                    "order": 1,
                    "description": "Application/Module name (e.g. Incidents)",
                    "required": true,
                    "contains": [
                        "archer application"
                    ]
                },
                "json_string": {
                    "data_type": "string",
                    "order": 2,
                    "description": "JSON data string",
                    "required": true
                }
            },
            "output": [
                {
                    "column_name": "New Content ID",
                    "column_order": 0,
                    "data_path": "action_result.summary.content_id",
                    "data_type": "numeric",
                    "contains": [
                        "archer content id"
                    ]
                },
                {
                    "column_name": "Application",
                    "column_order": 1,
                    "data_path": "action_result.parameter.application",
                    "data_type": "string",
                    "contains": [
                        "archer application"
                    ]
                },
                {
                    "data_path": "action_result.data.*.content_id",
                    "data_type": "numeric",
                    "contains": [
                        "archer content id"
                    ]
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.json_string",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric"
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric"
                }
            ],
            "render": {
                "type": "table",
                "title": "New Archer Record Info",
                "width": 2,
                "height": 5
            },
            "versions": "EQ(*)"
        },
        {
            "action": "update ticket",
            "description": "Update the value of a field of a record.",
            "verbose": "There are multiple ways of locating a ticket to update. You must either give the content ID for the record, which can be obtained from Archer or by specifying both the name of the Tracking ID field (name_field) and the Tracking ID (name_value).",
            "type": "generic",
            "identifier": "update_ticket",
            "read_only": false,
            "parameters": {
                "application": {
                    "data_type": "string",
                    "order": 0,
                    "description": "Application/Module name (e.g. Incidents)",
                    "required": true,
                    "contains": [
                        "archer application"
                    ]
                },
                "content_id": {
                    "data_type": "numeric",
                    "order": 1,
                    "description": "Content ID (Identifies the specific record)",
                    "required": false,
                    "primary": true,
                    "contains": [
                        "archer content id"
                    ]
                },
                "name_field": {
                    "data_type": "string",
                    "order": 2,
                    "description": "Name of Tracking ID field (e.g. \"Incident ID\")",
                    "required": false
                },
                "name_value": {
                    "data_type": "string",
                    "order": 3,
                    "description": "Name of record (e.g. \"INC-1234\")",
                    "required": false,
                    "primary": true,
                    "contains": [
                        "archer user-friendly id"
                    ]
                },
                "field_id": {
                    "data_type": "string",
                    "order": 4,
                    "description": "ID or name of the field to update in the record",
                    "required": true
                },
                "value": {
                    "data_type": "string",
                    "order": 5,
                    "description": "New value of the record's field",
                    "required": true
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.content_id",
                    "data_type": "numeric",
                    "contains": [
                        "archer content id"
                    ]
                },
                {
                    "column_name": "Archer Application",
                    "column_order": 0,
                    "data_path": "action_result.parameter.application",
                    "data_type": "numeric",
                    "contains": [
                        "archer application"
                    ]
                },
                {
                    "column_name": "Content ID",
                    "column_order": 1,
                    "data_path": "action_result.summary.content_id",
                    "data_type": "numeric",
                    "contains": [
                        "archer content id"
                    ]
                },
                {
                    "column_name": "Field Name",
                    "column_order": 2,
                    "data_path": "action_result.parameter.field_id",
                    "data_type": "string"
                },
                {
                    "column_name": "Field Value",
                    "column_order": 3,
                    "data_path": "action_result.parameter.value",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.name_field",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.name_value",
                    "data_type": "string",
                    "contains": [
                        "archer user-friendly id"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric"
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric"
                }
            ],
            "render": {
                "type": "table",
                "title": "New Archer Record Info",
                "width": 2,
                "height": 5
            },
            "versions": "EQ(*)"
        },
        {
            "action": "get ticket",
            "description": "Get ticket information.",
            "verbose": "There are multiple ways of locating a ticket. You must either give the content ID for the record, which can be obtained from Archer or by specifying both the name of the Tracking ID field (name_field) and the Tracking ID (name_value).<br><br>Unlike \"list tickets\" a field that allows multiple values may not show a \"multi_value\" attribute if there are one or zero values currently selected.",
            "type": "generic",
            "identifier": "get_ticket",
            "read_only": true,
            "parameters": {
                "application": {
                    "data_type": "string",
                    "order": 1,
                    "description": "Application/Module name (e.g. Incidents)",
                    "contains": [
                        "archer application"
                    ],
                    "required": true
                },
                "content_id": {
                    "data_type": "numeric",
                    "order": 2,
                    "description": "Content ID (Identifies the specific record)",
                    "required": false,
                    "primary": true,
                    "contains": [
                        "archer content id"
                    ]
                },
                "name_field": {
                    "data_type": "string",
                    "order": 3,
                    "description": "Name of Tracking ID field (e.g. \"Incident ID\")",
                    "required": false
                },
                "name_value": {
                    "data_type": "string",
                    "order": 4,
                    "description": "Name of record (e.g. \"INC-1234\")",
                    "required": false,
                    "primary": true,
                    "contains": [
                        "archer user-friendly id"
                    ]
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.content_id",
                    "data_type": "numeric",
                    "contains": [
                        "archer content id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.Record.@id",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Record.Field.*.@id",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Record.Field.*.@name",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Record.Field.*.@type",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Record.Field.*.@value",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Record.Field.*.multi_value",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Record.Field.*.@valueID",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Record.Field.*.@parentId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Record.Field.*.Groups.Group.*.@id",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Record.Field.*.Groups.Group.*.@desc",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Record.Field.*.Groups.Group.*.@name",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Record.Field.*.Groups.Group.*.@updateDate",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Record.Field.*.Groups.Group.*.@updateLogin",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Record.Field.*.@updateDate",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Record.Field.*.@updateLogin",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Record.Field.*.@width",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Record.Field.*.@height",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.@moduleId",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.data.*.@contentId",
                    "data_type": "string",
                    "contains": [
                        "archer content id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.Record.@updateDate",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Record.@updateLogin",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Record.@sequentialId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.name_field",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.name_value",
                    "data_type": "string",
                    "contains": [
                        "archer user-friendly id"
                    ]
                },
                {
                    "data_path": "action_result.parameter.application",
                    "data_type": "string",
                    "contains": [
                        "archer application"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric"
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric"
                }
            ],
            "render": {
                "type": "custom",
                "title": "New Archer Record Info",
                "width": 2,
                "height": 5,
                "view": "archer_views.get_ticket"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "list tickets",
            "description": "Get a list of tickets in an application.",
            "verbose": "You must provide both the field name/ID (name_field) and the value to search for (search_value) to search in records. You may also provide neither to get an unfiltered list",
            "type": "generic",
            "identifier": "list_tickets",
            "read_only": true,
            "parameters": {
                "application": {
                    "data_type": "string",
                    "order": 1,
                    "description": "Application/Module name (e.g. Incidents)",
                    "required": true,
                    "contains": [
                        "archer application"
                    ]
                },
                "max_results": {
                    "data_type": "numeric",
                    "order": 2,
                    "description": "Max number of records to return",
                    "required": true,
                    "default": 100
                },
                "name_field": {
                    "data_type": "string",
                    "order": 3,
                    "description": "Name of field to search in (e.g. \"Incident ID\")",
                    "required": false
                },
                "search_value": {
                    "data_type": "string",
                    "order": 4,
                    "description": "Value to search for in this application",
                    "required": false
                }
            },
            "output": [
                {
                    "data_path": "action_result.data.*.Field.*.@id",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Field.*.#text",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Field.*.multi_value",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Field.*.@guid",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Field.*.@name",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Field.*.@type",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.Field.*.@xmlConvertedValue",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.@levelId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.@moduleId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.@parentId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.@contentId",
                    "data_type": "string",
                    "contains": [
                        "archer content id"
                    ]
                },
                {
                    "data_path": "action_result.data.*.@levelGuid",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.records_found",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.parameter.name_field",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.application",
                    "data_type": "string",
                    "contains": [
                        "archer application"
                    ]
                },
                {
                    "data_path": "action_result.parameter.max_results",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.search_value",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric"
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric"
                }
            ],
            "render": {
                "type": "custom",
                "title": "New Archer Record Info",
                "width": 2,
                "height": 5,
                "view": "archer_views.list_tickets"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "on poll",
            "description": "Callback action for the on_poll ingest functionality.",
            "verbose": "This action has a persistent copy of the most recent 'Date Created' value it's seen on any sucessfully processed record.  It uses this to pull all records created since then, and creates a Phantom container for each.  Records are pulled by referencing that 'poll_report' key of each cef_mapping entry.  If any such entry does not have a 'poll_report' key, it is skipped; otherwise, the Archer report named by that key's value will be used as a list of records to pull and process according to that mapping.",
            "type": "ingest",
            "identifier": "on_poll",
            "read_only": true,
            "parameters": {
                "start_time": {
                    "data_type": "numeric",
                    "order": 1,
                    "description": "Start of time range, in epoch time (milliseconds)  If not specified, the default is the past_days setting of the App."
                },
                "end_time": {
                    "data_type": "numeric",
                    "order": 2,
                    "description": "End of time range, in epoch time (milliseconds)  If not specified, the default is now"
                },
                "container_count": {
                    "data_type": "numeric",
                    "order": 3,
                    "description": "Maximum number of container records to query for."
                },
                "artifact_count": {
                    "data_type": "numeric",
                    "order": 4,
                    "description": "Maximum number of artifact records to query for."
                }
            },
            "output": [],
            "versions": "EQ(*)"
        }
    ]
}